(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     16200,        515]
NotebookOptionsPosition[     13039,        399]
NotebookOutlinePosition[     13378,        414]
CellTagsIndexPosition[     13335,        411]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["NRMMA", "Title",
 CellChangeTimes->{{3.4742276628182783`*^9, 3.474227665279182*^9}}],

Cell[TextData[{
 "Numerical Relativity in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\nby Ian Hinder"
}], "Subsubtitle",
 CellChangeTimes->{{3.474227672129909*^9, 3.474227680854444*^9}, {
  3.474228710011757*^9, 3.474228715253462*^9}}],

Cell[TextData[{
 "NRMMA is a suite of ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " packages for analysing data in Numerical Relativity.  It has been designed \
for use with common output formats used by the Cactus code, with a focus on \
output from the PSU and AEI codes.  Some components are much more general \
than this though."
}], "Text",
 CellChangeTimes->{{3.474227694270174*^9, 3.4742277821150312`*^9}}],

Cell[CellGroupData[{

Cell["Installation", "Section",
 CellChangeTimes->{{3.480238974819901*^9, 3.480238975963613*^9}}],

Cell[TextData[{
 "You will need to make sure that the directory containing the NRMMA packages \
is found on your ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " path.  The recommended way to do this is to edit your ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " kernel init.m file to contain the line"
}], "Text",
 CellChangeTimes->{{3.4802389807235193`*^9, 3.480239017482188*^9}}],

Cell["\t$Path = Join[{\"<path containing nrmma>/nrmma\"}, $Path];", "Text",
 CellChangeTimes->{{3.4802390553784943`*^9, 3.48023908397822*^9}, 
   3.480239861149198*^9}],

Cell[TextData[{
 "On Mac OS, the init.m file can be found in \
Library/Mathematica/Kernel/init.m in your home directory.  After doing this, \
you should restart the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " kernel so that the file is re-read."
}], "Text",
 CellChangeTimes->{{3.480239085568019*^9, 3.480239136101857*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Getting Started", "Section",
 CellChangeTimes->{{3.4802391511910057`*^9, 3.4802391530933313`*^9}}],

Cell[CellGroupData[{

Cell["Loading packages", "Subsection",
 CellChangeTimes->{{3.480239944771925*^9, 3.480239946498764*^9}}],

Cell["In order to load one of the NRMMA packages, use", "Text",
 CellChangeTimes->{{3.4802391564931383`*^9, 3.480239163549015*^9}}],

Cell["\t<< \"package.m\"", "Text",
 CellChangeTimes->{{3.480239167812935*^9, 3.480239176004702*^9}, 
   3.4802394703696337`*^9}],

Cell["For example,", "Text",
 CellChangeTimes->{{3.480239177876499*^9, 3.4802391791722918`*^9}}],

Cell["\t<< \"NR.m\"", "Text",
 CellChangeTimes->{{3.480239181460348*^9, 3.4802391840043488`*^9}, 
   3.480239471745679*^9}],

Cell["\<\
Packages load any other packages they need, and NR.m actually loads most of \
the other packages. To get started, have a look at the NR package, which \
contains most of the immediately useful functions. \
\>", "Text",
 CellChangeTimes->{{3.480239190044187*^9, 3.480239205747918*^9}, {
  3.480240021951584*^9, 3.480240025112344*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding simulation directories", "Subsection",
 CellChangeTimes->{{3.480239949762188*^9, 3.480239953843713*^9}}],

Cell["\<\
NRMMA has an interface for accessing \"simulations\" which are directories \
containing simulation output.  The name of the simulation is the name of the \
directory.  You can either specify a simulation by a full path, or by the \
simulation name.  For the latter, NRMMA needs to know which directory to look \
in.  You can set the variable RunDirectory to this directory and NRMMA will \
then know where to find your simulations. For example, in your init.m you can \
set

\tRunDirectory = \"/Users/username/Simulations\";

if you have your simulations in that directory.
\
\>", "Text",
 CellChangeTimes->{{3.480239221972322*^9, 3.480239282449183*^9}, {
   3.480239375231709*^9, 3.480239468260503*^9}, {3.4802395108750057`*^9, 
   3.4802395256880207`*^9}, {3.480239566976172*^9, 3.48023961313855*^9}, {
   3.480239922451157*^9, 3.480239927611414*^9}, 3.4802399614272423`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["SimFactory", "Subsection",
 CellChangeTimes->{{3.480239975777763*^9, 3.4802399769853687`*^9}}],

Cell["\<\
NRMMA supports SimFactory simulations, and should also support individual \
Cactus output directories as simulations, though this has not been tested \
recently.  \
\>", "Text",
 CellChangeTimes->{{3.4802399677966337`*^9, 3.48024003277852*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chunking", "Subsection",
 CellChangeTimes->{{3.48024004540891*^9, 3.4802400474467688`*^9}}],

Cell["\<\
Simulations usually take more than one job on a supercomputer, and the output \
is spread across many different output directories (\"chunks\").  NRMMA \
supports the SimFactory chunking mechanism and almost all the file reading \
functions go through a layer which automatically merges the files in these \
chunks together, taking care to eliminate any duplicate data.  As such, you \
should never have to worry about merging chunks of data together, and in fact \
you can probably forget about the fact that the simulation data is split into \
chunks.\
\>", "Text",
 CellChangeTimes->{{3.4802400491508417`*^9, 3.480240140060001*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["DataTables", "Subsection",
 CellChangeTimes->{{3.480239992104896*^9, 3.4802399935049143`*^9}}],

Cell["\<\
NRMMA uses the DataTable package extensively to represent tables of \
simulation data, so you should also look at that package to familiarise \
yourself with the concepts (it is documented; see below).\
\>", "Text",
 CellChangeTimes->{{3.480239999465416*^9, 3.48024000120901*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Memoisation", "Subsection",
 CellChangeTimes->{{3.480239982993236*^9, 3.480239984433243*^9}}],

Cell["\<\
Note that some functions use \"memoisation\".  In other words, the first time \
a particular quantity is accessed, for example a waveform, it is cached in \
memory so that later calls to the function do not have to read the data off \
the disk again.  When using very long simulations this can save a significant \
amount of time.  However, beware that if the run data on the disk changes, \
the copy in memory will not be.  To clear the cache, use the function

\tClearAllMemos[]

It would be possible to modify the caching algorithm to read the data again \
when it changes on disk, but this has not been done yet.\
\>", "Text",
 CellChangeTimes->{{3.480239751925939*^9, 3.480239851038506*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["NR Packages", "Section",
 CellChangeTimes->{{3.4742278023401318`*^9, 3.474227803298568*^9}, {
  3.474228578212574*^9, 3.4742285785458727`*^9}}],

Cell[CellGroupData[{

Cell["NR", "Subsection",
 CellChangeTimes->{{3.47422797928489*^9, 3.4742279794052963`*^9}}],

Cell[TextData[{
 ButtonBox["(documentation)",
  BaseStyle->"Hyperlink",
  ButtonData->{"NR.nb", None}],
 " A large selection of NR-related functions.  Includes interfaces to: read \
data from simulation output directories including waveforms, BH trajectories, \
apparent horizons, isolated horizons.  Extrapolation of radiated quantities \
to r = infinity.  Convergence testing.  Computation of strain from Psi4.  \
Reading grid structure values.  Exporting simulation data to a standard \
uniform format.  "
}], "Text",
 CellChangeTimes->{{3.4742280971532593`*^9, 3.474228295340266*^9}, {
  3.480238920686363*^9, 3.480238921573749*^9}, {3.480238953501337*^9, 
  3.4802389624523487`*^9}}],

Cell["These will in future be split into separate packages.", "Text",
 CellChangeTimes->{{3.474228275667487*^9, 3.4742282888109217`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["SimView", "Subsection",
 CellChangeTimes->{{3.474228013132503*^9, 3.474228014116336*^9}}],

Cell[TextData[{
 ButtonBox["(documentation)",
  BaseStyle->"Hyperlink",
  ButtonData->{"SimView.nb", None}],
 " Provide a quick graphical overview of a BBH simulation including plots of \
the waveforms, trajectories, run speed, memory usage, simulation chunks, \
start times, end times."
}], "Text",
 CellChangeTimes->{{3.474228512683572*^9, 3.4742285547223387`*^9}, {
  3.47422866722462*^9, 3.474228667823196*^9}, {3.480239716226738*^9, 
  3.480239731266253*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kicks", "Subsection",
 CellChangeTimes->{{3.4742280062124453`*^9, 3.474228006699897*^9}}],

Cell["\<\
(undocumented) Computing linear momentum fluxes and kicks from waveforms.\
\>", "Text",
 CellChangeTimes->{{3.474228465495894*^9, 3.4742284769086933`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quasinormal", "Subsection",
 CellChangeTimes->{{3.47422798754123*^9, 3.474227990124584*^9}}],

Cell["\<\
(undocumented) Computation of quasinormal modes from waveforms.\
\>", "Text",
 CellChangeTimes->{{3.474228366120723*^9, 3.474228373944394*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utility Packages", "Section",
 CellChangeTimes->{{3.4742285836666183`*^9, 3.4742285864498577`*^9}}],

Cell[CellGroupData[{

Cell["DataTable", "Subsection",
 CellChangeTimes->{{3.474227807589346*^9, 3.474227808866528*^9}}],

Cell[TextData[{
 ButtonBox["(documentation)",
  BaseStyle->"Hyperlink",
  ButtonData->{"DataTable.nb", None}],
 " A representation of 1D data along with convenient manipulation functions."
}], "Text",
 CellChangeTimes->{
  3.47422784340208*^9, 3.4742279070718327`*^9, {3.474228806249792*^9, 
   3.474228809110211*^9}, {3.47422884130307*^9, 3.474228841303728*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Memo", "Subsection",
 CellChangeTimes->{{3.4742279763988323`*^9, 3.47422797678889*^9}}],

Cell["\<\
(undocumented) Memoisation of functions; i.e. in-memory caching of values so \
that they don't have to be recomputed.\
\>", "Text",
 CellChangeTimes->{{3.474228072180765*^9, 3.474228094545085*^9}, 
   3.4742283083557043`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting", "Subsection",
 CellChangeTimes->{{3.4742279579645653`*^9, 3.474227958813999*^9}}],

Cell["\<\
(undocumented) A version of ListLinePlot which allows zooming by dragging a \
box with the mouse, as well as wrappers for presentation-quality plots and \
plot legends.\
\>", "Text",
 CellChangeTimes->{{3.4742280293152037`*^9, 3.474228069082131*^9}, 
   3.4742283064354353`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Profile", "Subsection",
 CellChangeTimes->{{3.4742279818128967`*^9, 3.474227982636805*^9}}],

Cell["\<\
(undocumented) Support for adding timing information to functions which can \
be queried later.\
\>", "Text",
 CellChangeTimes->{{3.47422835345973*^9, 3.474228363232706*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Movie", "Subsection",
 CellChangeTimes->{{3.474228009004189*^9, 3.474228009547977*^9}}],

Cell["\<\
(undocumented) Generating image files and movies using an external tool (e.g. \
ffmpeg)\
\>", "Text",
 CellChangeTimes->{{3.474228481415941*^9, 3.474228508811831*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cactus and SimFactory data", "Section",
 CellChangeTimes->{{3.4742286298584337`*^9, 3.474228644399728*^9}}],

Cell[CellGroupData[{

Cell["Ascii1D", "Subsection",
 CellChangeTimes->{{3.474227852065496*^9, 3.474227853609109*^9}}],

Cell[TextData[{
 ButtonBox["(documentation)",
  BaseStyle->"Hyperlink",
  ButtonData->{"Ascii1D.nb", None}],
 " Manipulating time-dependent 1D data files."
}], "Text",
 CellChangeTimes->{{3.474227889633932*^9, 3.474227902447908*^9}, {
  3.474228848143927*^9, 3.4742288662606173`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["RunFiles", "Subsection",
 CellChangeTimes->{{3.474227993236487*^9, 3.4742279943324833`*^9}}],

Cell["\<\
(undocumented) An abstract interface for reading possibly chunked data from \
SimFactory (or other) simulation data directories.  The user asks for the \
filename and the package finds the data in the simulation output directory \
and merges the separate chunks before returning it to the user.\
\>", "Text",
 CellChangeTimes->{{3.474228376432436*^9, 3.4742284291106157`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Timers", "Subsection",
 CellChangeTimes->{{3.47422799802843*^9, 3.4742279986524267`*^9}}],

Cell["(undocumented) Reading TimerReport output files.", "Text",
 CellChangeTimes->{{3.474228437152779*^9, 3.4742284521098213`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grids", "Subsection",
 CellChangeTimes->{{3.474228003308509*^9, 3.4742280039834833`*^9}}],

Cell["(undocumented) Reading and plotting Carpet grid structures.", "Text",
 CellChangeTimes->{{3.474228454861855*^9, 3.47422846128542*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{724, 981},
WindowMargins->{{78, Automatic}, {Automatic, 0}},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 90, 1, 76, "Title"],
Cell[660, 25, 246, 7, 43, "Subsubtitle"],
Cell[909, 34, 422, 9, 56, "Text"],
Cell[CellGroupData[{
Cell[1356, 47, 97, 1, 67, "Section"],
Cell[1456, 50, 396, 10, 41, "Text"],
Cell[1855, 62, 168, 2, 26, "Text"],
Cell[2026, 66, 334, 8, 41, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2397, 79, 104, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[2526, 84, 104, 1, 34, "Subsection"],
Cell[2633, 87, 131, 1, 26, "Text"],
Cell[2767, 90, 128, 2, 26, "Text"],
Cell[2898, 94, 96, 1, 26, "Text"],
Cell[2997, 97, 123, 2, 26, "Text"],
Cell[3123, 101, 343, 6, 41, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3503, 112, 118, 1, 34, "Subsection"],
Cell[3624, 115, 887, 17, 146, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4548, 137, 100, 1, 34, "Subsection"],
Cell[4651, 140, 254, 5, 41, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4942, 150, 97, 1, 34, "Subsection"],
Cell[5042, 153, 645, 10, 86, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5724, 168, 100, 1, 34, "Subsection"],
Cell[5827, 171, 290, 5, 41, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6154, 181, 99, 1, 34, "Subsection"],
Cell[6256, 184, 706, 13, 146, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7011, 203, 149, 2, 67, "Section"],
Cell[CellGroupData[{
Cell[7185, 209, 91, 1, 34, "Subsection"],
Cell[7279, 212, 688, 13, 71, "Text"],
Cell[7970, 227, 137, 1, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8144, 233, 95, 1, 34, "Subsection"],
Cell[8242, 236, 464, 10, 41, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8743, 251, 95, 1, 34, "Subsection"],
Cell[8841, 254, 165, 3, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9043, 262, 98, 1, 34, "Subsection"],
Cell[9144, 265, 153, 3, 26, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9346, 274, 105, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[9476, 279, 97, 1, 34, "Subsection"],
Cell[9576, 282, 363, 8, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9976, 295, 93, 1, 34, "Subsection"],
Cell[10072, 298, 235, 5, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10344, 308, 98, 1, 34, "Subsection"],
Cell[10445, 311, 288, 6, 41, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10770, 322, 97, 1, 34, "Subsection"],
Cell[10870, 325, 184, 4, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11091, 334, 93, 1, 34, "Subsection"],
Cell[11187, 337, 177, 4, 26, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11413, 347, 113, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[11551, 352, 95, 1, 34, "Subsection"],
Cell[11649, 355, 284, 7, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11970, 367, 98, 1, 34, "Subsection"],
Cell[12071, 370, 386, 6, 56, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12494, 381, 95, 1, 34, "Subsection"],
Cell[12592, 384, 132, 1, 26, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12761, 390, 95, 1, 34, "Subsection"],
Cell[12859, 393, 140, 1, 26, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
