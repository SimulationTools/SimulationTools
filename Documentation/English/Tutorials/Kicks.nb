Notebook[{
Cell[" ", "TutorialColorBar",
 CellMargins->{{Inherited, Inherited}, {-5, 0}}],

Cell[TextData[{
 ButtonBox["nrmma",
  BaseStyle->{"Link", "LinkTrail"},
  ButtonData->"paclet:nrmma/guide/nrmma"],
 StyleBox[" > ", "LinkTrailSeparator"],
 ButtonBox["Kicks",
  BaseStyle->{"Link", "LinkTrail"},
  ButtonData->"paclet:nrmma/tutorial/Kicks"]
}], "LinkTrail"],

Cell[BoxData[GridBox[{
   {Cell["KICKS TUTORIAL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"Related Tutorials \[RightGuillemet]\"\>",
        StripOnInput->False], {"DataTable":>Documentation`HelpLookup[
       "paclet:nrmma/tutorial/DataTable"], "NumericalRelativity":>
       Documentation`HelpLookup["paclet:nrmma/tutorial/NumericalRelativity"]},
       
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox["\<\"URL \[RightGuillemet]\"\>",
        StripOnInput->False], {"\<\"Go to nrmma website\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[None], None}]}], 
       Delimiter, "\<\"Go to wolfram Mathematica website\"\>":>
       FrontEndExecute[{
         NotebookLocate[{
           URL[
           "http://reference.wolfram.com/mathematica/guide/Mathematica.html"],
            None}]}]},
       Appearance->None,
       MenuAppearance->Automatic]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid"],

Cell[CellGroupData[{

Cell["Kicks", "Title"],

Cell[TextData[{
 "The Kicks package provides optimised functions for computing the linear \
momentum radiated in gravitational waves from the spherical harmonic modes of \
",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalPsi]", "4"], TraditionalForm]]],
 ".  There is an example dataset used by this documentation from a binary \
black hole simulation with mass ratio 1:3, both BHs having dimensionless spin \
0.8 initially oriented in the orbital plane.  This package uses the ",
 ButtonBox["ReadPsi4",
  BaseStyle->"Link",
  ButtonData->"paclet:nrmma/ref/ReadPsi4"],
 " function defined in the NR package, so it supports all the mode \
decomposition thorns supported by that package.  This includes Multipole \
(HDF5 and ASCII) and Ylm_Decomp."
}], "Text"],

Cell[BoxData[GridBox[{
   {"AngularMomentumFlux", Cell["LinearMomentumFlux", "TableText"]},
   {"Kick", Cell["LinearMomentumRadiated", "TableText"]},
   {"KickVector", "\[Placeholder]"}
  }]], "DefinitionBox"],

Cell["Functions provided by the Kicks package.", "Caption"],

Cell[CellGroupData[{

Cell["Examples", "Section"],

Cell["\<\
Binary black hole simulation with mass ratio 1:3, both BHs having \
dimensionless spin 0.8 initially oriented in the orbital plane\
\>", "MathCaption"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"run", "=", "\"\<~/Simulations/spinkicks/q3s08_4e\>\""}], ";"}], 
  "*)"}]], "Input",
 CellLabel->"In[1]:="],

Cell["\<\
Here we take the radius r = 100, the z-component, and use only the modes up \
to l = 4.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PresentationListLinePlot", "[", 
   RowBox[{
    RowBox[{"LinearMomentumFlux", "[", 
     RowBox[{"run", ",", " ", "3", ",", " ", "100", ",", " ", "4"}], "]"}], 
    ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "*)"}]], "Input",
 CellLabel->"In[2]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PresentationListLinePlot", "[", 
   RowBox[{
    RowBox[{"LinearMomentumRadiated", "[", 
     RowBox[{"run", ",", " ", "3", ",", " ", "100", ",", " ", "4"}], "]"}], 
    ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "*)"}]], "Input",
 CellLabel->"In[3]:="],

Cell["The kicks are measured in km/s.  ", "Text"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Kick", "[", 
   RowBox[{"run", ",", " ", "3", ",", " ", "100", ",", " ", "4"}], "]"}], 
  "*)"}]], "Input",
 CellLabel->"In[4]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"KickVector", "[", 
   RowBox[{"run", ",", "100", ",", "2"}], "]"}], "*)"}]], "Input",
 CellLabel->"In[5]:="],

Cell["\<\
Extrapolate the z-component of the kick to r = \[Infinity]:\
\>", "Text"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"rads", "=", 
   RowBox[{"ReadPsi4Radii", "[", "run", "]"}]}], "*)"}]], "Input",
 CellLabel->"In[6]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"vzOfr", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", 
         RowBox[{"Kick", "[", 
          RowBox[{"run", ",", "3", ",", "r", ",", "4"}], "]"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"r", ",", "rads"}], "}"}]}], "]"}], ",", "r"}], "]"}]}], 
  "*)"}]], "Input",
 CellLabel->"In[7]:="],

Cell["\<\
We extrapolate by fitting to a first degree polynomial in 1/r:\
\>", "Text"],

Cell[TextData[{
 "v(r) = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "\[Infinity]"], TraditionalForm]]],
 " + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "1"], TraditionalForm]]],
 "/r"
}], "Text"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"extrap", "=", 
   RowBox[{"ExtrapolateScalarFull", "[", 
    RowBox[{"1", ",", "vzOfr"}], "]"}]}], "*)"}]], "Input",
 CellLabel->"In[8]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PresentationListLinePlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Data", "/.", "extrap"}], ",", 
      RowBox[{"ExtrapolatedCurve", "/.", "extrap"}]}], "}"}], ",", 
    RowBox[{"Joined", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}]}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<1/r\>\"", ",", "\"\<\!\(\*SubscriptBox[\(v\), \(z\)]\)\>\""}], 
      "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}], "*)"}]], "Input",
 CellLabel->"In[9]:="],

Cell["The extrapolated kick is", "Text"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ExtrapolatedValue", "/.", "extrap"}], "*)"}]], "Input",
 CellLabel->"In[10]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extrapolated Flux", "Section"],

Cell["\<\
We take only the highest 4 radii, because the lower radii don\
\[CloseCurlyQuote]t extrapolate well (probably too low).  Again we look at \
the z component of the flux up to l = 4.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"pDotOfr", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", 
         RowBox[{"LinearMomentumFlux", "[", 
          RowBox[{"run", ",", " ", "3", ",", " ", "r", ",", " ", "4"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", 
         RowBox[{"Take", "[", 
          RowBox[{"rads", ",", 
           RowBox[{"-", "4"}]}], "]"}]}], "}"}]}], "]"}], ",", "r"}], "]"}]}],
   "*)"}]], "Input",
 CellLabel->"In[1]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PresentationListLinePlot", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Last", ",", "pDotOfr"}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "*)"}]], "Input",
 CellLabel->"In[2]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"mADM", "=", 
   RowBox[{"ReadADMMass", "[", "run", "]"}]}], "*)"}]], "Input",
 CellLabel->"In[3]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"pDot", "=", 
   RowBox[{"ExtrapolateRadiatedQuantity", "[", 
    RowBox[{"pDotOfr", ",", 
     RowBox[{"MassADM", "\[Rule]", "mADM"}]}], "]"}]}], "*)"}]], "Input",
 CellLabel->"In[4]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"shiftedpDots", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ShiftDataTable", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"TortoiseCoordinate", "[", 
          RowBox[{"#1", ",", "mADM"}], "]"}]}], ",", "#2"}], "]"}], "&"}], 
     ",", 
     RowBox[{"Transpose", "@", "pDotOfr"}]}], "]"}]}], "*)"}]], "Input",
 CellLabel->"In[5]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"labels", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"\"\<r = \>\"", "<>", 
        RowBox[{"ToString", "[", "r", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", 
         RowBox[{"First", "/@", "pDotOfr"}]}], "}"}]}], "]"}], ",", 
     "\"\<r = \[Infinity]\>\""}], "]"}]}], "*)"}]], "Input",
 CellLabel->"In[6]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PresentationListLinePlot", "[", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{"shiftedpDots", ",", "pDot"}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"400", ",", "500"}], "}"}], ",", "All"}], "}"}]}], ",", 
    RowBox[{"PlotLegend", "\[Rule]", "labels"}]}], "]"}], "*)"}]], "Input",
 CellLabel->"In[7]:="],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PresentationListLinePlot", "[", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{"shiftedpDots", ",", "pDot"}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"470", ",", "476"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.00014", ",", "0.00017"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegend", "\[Rule]", "labels"}]}], "]"}], "*)"}]], "Input",
 CellLabel->"In[8]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[ButtonBox["RELATED TUTORIALS",
 BaseStyle->None,
 Appearance->{Automatic, None},
 Evaluator->None,
 Method->"Preemptive",
 ButtonFunction:>(FrontEndExecute[{
    FrontEnd`SelectionMove[
     FrontEnd`SelectedNotebook[], All, ButtonCell], 
    FrontEndToken["OpenCloseGroup"], 
    FrontEnd`SelectionMove[
     FrontEnd`SelectedNotebook[], After, 
     CellContents]}]& )]], "RelatedTutorialsSection",
 WholeCellGroupOpener->True],

Cell[TextData[ButtonBox["DataTable",
 BaseStyle->"Link",
 ButtonData->"paclet:nrmma/tutorial/DataTable"]], "RelatedTutorials"],

Cell[TextData[ButtonBox["NumericalRelativity",
 BaseStyle->"Link",
 ButtonData->"paclet:nrmma/tutorial/NumericalRelativity"]], "RelatedTutorials"]
}, Open  ]]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Kicks",
Visible->True,
PrivateNotebookOptions->{"FileOutlineCache"->False},
TaggingRules->{
 "ModificationHighlight" -> False, 
  "Metadata" -> {
   "context" -> "nrmma`", "keywords" -> {}, "index" -> True, "label" -> 
    "nrmma Tutorial", "language" -> "en", "paclet" -> "Kicks", "status" -> 
    "None", "summary" -> "Tutorial for the Kicks package.", "synonyms" -> {}, 
    "title" -> "Kicks", "windowTitle" -> "Kicks", "type" -> "Tutorial", "uri" -> 
    "nrmma/tutorial/Kicks"}, "SearchTextTranslated" -> "", "LinkTrails" -> ""},
TrackCellChangeTimes->False,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Reference.nb", 
  CharacterEncoding -> "UTF-8"]
]

